

```python3
class Solution:
    def calcEquation(self,
                     equations: List[List[str]],
                     values: List[float],
                     queries: List[List[str]]) -> List[float]:
        n = len(equations)
        dct = defaultdict(list)
        for i in range(n):
            a, b = equations[i]
            dct[a][b] = values[i]
            dct[b][a] = 1 / values[i]
            dct[a][a] = 1
            dct[b][b] = 1

        def check(x, y):
            if x == y:
                return 1 if x in dct else -1
            stack = [[x, 1]] if x in dct else []
            visit = {x} if x in dct else {}
            while stack:
                nex = []
                for k, res in stack:
                    for j in dct[k]:
                        if j not in visit:
                            visit.add(j)
                            nex.append([j, res * dct[k][j]])
                            if y == j:
                                return res * dct[k][j]
                stack = nex
            return -1

        return [check(a, b) for a, b in queries]
```